2013-05-10  Laszlo Gombos  <l.gombos@samsung.com>

        Remove USE(OS_RANDOMNESS)
        https://bugs.webkit.org/show_bug.cgi?id=108095

        Reviewed by Darin Adler.

        Remove the USE(OS_RANDOMNESS) guard as it is turned on for all
        ports.

        * WebCoreSupport/AboutDataUseFeatures.in:

2013-05-10  Jacky Jiang  <zhajiang@blackberry.com>

        Fix some compiler warnings (miscellaneous)
        https://bugs.webkit.org/show_bug.cgi?id=80790

        Reviewed by Rob Buis.

        Fix the following warnings for BlackBerry:
        BackingStore.cpp:852:60: warning: suggest parentheses around '&&' within
        '||' [-Wparentheses].
        WebPage.cpp:2858:40: warning: suggest parentheses around assignment used
        as truth value [-Wparentheses].
        WebPage.cpp:2880:42: warning: suggest parentheses around assignment used
        as truth value [-Wparentheses]

        * Api/BackingStore.cpp:
        (BlackBerry::WebKit::BackingStorePrivate::updateTilesAfterBackingStoreRectChange):
        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::adjustRectOffsetForFrameOffset):
        (BlackBerry::WebKit::WebPagePrivate::blockZoomRectForNode):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update iInRegionScroller, WebKitTextCodec and WebPageCompositor
        to match check-webkit-style updates.

        * Api/InRegionScroller.cpp:
        (BlackBerry::WebKit::InRegionScrollerPrivate::setScrollPositionCompositingThread):
        * Api/InRegionScroller_p.h:
        * Api/WebKitTextCodec.cpp:
        (BlackBerry::WebKit::transcode):
        * Api/WebPageCompositor.cpp:
        (BlackBerry::WebKit::WebPageCompositor::render):
        * Api/WebPageCompositor.h:
        * Api/WebPageCompositor_p.h:
        (WebPageCompositorPrivate):
        * Api/WebSettings_p.h:

2013-05-09  Max Feil  <mfeil@rim.com>

        shouldUsePluginDocument() needs to be respected when a document is created
        https://bugs.webkit.org/show_bug.cgi?id=110308

        Reviewed by Rob Buis.

        This patch implements shouldAlwaysUsePluginDocument() in the
        BlackBerry frame loader client. It is called in several places
        within WebCore to determine whether a PluginDocument should
        be created.

        * WebCoreSupport/FrameLoaderClientBlackBerry.cpp:
        (WebCore::FrameLoaderClientBlackBerry::shouldAlwaysUsePluginDocument):
        (WebCore):
        (WebCore::FrameLoaderClientBlackBerry::createPlugin):
        * WebCoreSupport/FrameLoaderClientBlackBerry.h:
        (FrameLoaderClientBlackBerry):

2013-05-09  Mike Fenton <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update SelectionHandler to match check-webkit-style updates.

        * WebKitSupport/SelectionHandler.cpp:
        (BlackBerry::WebKit::shouldExtendSelectionInDirection):
        (BlackBerry::WebKit::SelectionHandler::extendSelectionToFieldBoundary):
        (BlackBerry::WebKit::SelectionHandler::updateOrHandleInputSelection):
        (BlackBerry::WebKit::adjustCaretRects):
        (BlackBerry::WebKit::SelectionHandler::clipPointToVisibleContainer):
        (BlackBerry::WebKit::regionRectListContainsPoint):
        * WebKitSupport/SelectionHandler.h:
        (SelectionHandler):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update WebPage and WebPageClient to match check-webkit-style updates.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::init):
        (BlackBerry::WebKit::WebPage::executeJavaScriptInIsolatedWorld):
        (BlackBerry::WebKit::WebPagePrivate::zoomAboutPoint):
        (BlackBerry::WebKit::WebPagePrivate::calculateReflowedScrollPosition):
        (BlackBerry::WebKit::WebPagePrivate::centerOfVisibleContentsRect):
        (BlackBerry::WebKit::WebPage::assignFocus):
        (BlackBerry::WebKit::WebPagePrivate::resumeBackingStore):
        (BlackBerry::WebKit::WebPagePrivate::setViewportSize):
        (BlackBerry::WebKit::WebPage::deleteTextRelativeToCursor):
        (BlackBerry::WebKit::WebPage::addVisitedLink):
        (BlackBerry::WebKit::WebPagePrivate::findPatternStringForUrl):
        (BlackBerry::WebKit::WebPage::notifySwipeEvent):
        (BlackBerry::WebKit::WebPage::notifyScreenPowerStateChanged):
        (BlackBerry::WebKit::WebPagePrivate::commitRootLayerIfNeeded):
        (BlackBerry::WebKit::WebPagePrivate::setRootLayerWebKitThread):
        (BlackBerry::WebKit::WebPagePrivate::releaseLayerResourcesCompositingThread):
        * Api/WebPageClient.h:
        * Api/WebPage_p.h:

2013-05-09  Mike Fenton  <mifenton@rim.com>


        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update BackingStore to match check-webkit-style updates.

        Internally reviewed by Jakob Petsovits.

        * Api/BackingStore.cpp:
        (BlackBerry::WebKit::bestDivisor):
        (BlackBerry::WebKit::BackingStorePrivate::repaint):
        (BlackBerry::WebKit::BackingStorePrivate::shouldMoveLeft):
        (BlackBerry::WebKit::BackingStorePrivate::shouldMoveRight):
        (BlackBerry::WebKit::BackingStorePrivate::shouldMoveUp):
        (BlackBerry::WebKit::BackingStorePrivate::shouldMoveDown):
        (BlackBerry::WebKit::BackingStorePrivate::canMoveLeft):
        (BlackBerry::WebKit::BackingStorePrivate::canMoveRight):
        (BlackBerry::WebKit::BackingStorePrivate::canMoveUp):
        (BlackBerry::WebKit::BackingStorePrivate::canMoveDown):
        (BlackBerry::WebKit::BackingStorePrivate::indexOfTile):
        (BlackBerry::WebKit::BackingStorePrivate::clearAndUpdateTileOfNotRenderedRegion):
        (BlackBerry::WebKit::BackingStorePrivate::scrollBackingStore):
        (BlackBerry::WebKit::BackingStoreGeometry::originOfTile):
        (BlackBerry::WebKit::BackingStore::repaint):
        * Api/BackingStore_p.h:
        (BackingStoreGeometry):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update ChromeClientBlackBerry, CredentialManager, FrameLoaderClientBlackBerry,
        GeolocationClientBlackBerry and IconDatabaseClientBlackberry to
        match check-webkit-style updates.

        * WebCoreSupport/ChromeClientBlackBerry.h:
        (ChromeClientBlackBerry):
        * WebCoreSupport/CredentialManager.h:
        (CredentialManager):
        * WebCoreSupport/CredentialTransformData.cpp:
        * WebCoreSupport/FrameLoaderClientBlackBerry.h:
        (WebCore::FrameLoaderClientBlackBerry::assignIdentifierToInitialRequest):
        (FrameLoaderClientBlackBerry):
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidReceiveAuthenticationChallenge):
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidCancelAuthenticationChallenge):
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidReceiveContentLength):
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidFinishLoading):
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidFailLoading):
        * WebCoreSupport/GeolocationClientBlackBerry.cpp:
        (GeolocationClientBlackBerry::onLocationUpdate):
        * WebCoreSupport/GeolocationClientBlackBerry.h:
        (GeolocationClientBlackBerry):
        * WebCoreSupport/IconDatabaseClientBlackBerry.cpp:
        (WebCore::IconDatabaseClientBlackBerry::initIconDatabase):

2013-05-09  Jacky Jiang  <zhajiang@blackberry.com>

        Fix some compiler warnings (miscellaneous)
        https://bugs.webkit.org/show_bug.cgi?id=80790

        Reviewed by Rob Buis.

        Fix the following warnings for BlackBerry:
        InRegionScroller.cpp:286:39: warning: suggest parentheses around
        assignment used as truth value [-Wparentheses].
        InRegionScroller.cpp:349:39: warning: suggest parentheses around
        assignment used as truth value [-Wparentheses].
        InRegionScroller.cpp:456:82: warning: suggest parentheses around '&&'
        within '||' [-Wparentheses].
        InRegionScrollableArea.cpp:134:16: warning: suggest explicit braces to
        avoid ambiguous 'else' [-Wparentheses].
        SelectionHandler.cpp:390:109: warning: suggest parentheses around '&&'
        within '||' [-Wparentheses].
        SelectionOverlay.cpp:56:47: warning: comparison between signed and
        unsigned integer expressions [-Wsign-compare].


        * Api/InRegionScroller.cpp:
        (BlackBerry::WebKit::InRegionScrollerPrivate::calculateInRegionScrollableAreasForPoint):
        (BlackBerry::WebKit::InRegionScrollerPrivate::firstScrollableInRegionForNode):
        (BlackBerry::WebKit::InRegionScrollerPrivate::canScrollRenderBox):
        * WebKitSupport/InRegionScrollableArea.cpp:
        (BlackBerry::WebKit::InRegionScrollableArea::InRegionScrollableArea):
        * WebKitSupport/SelectionHandler.cpp:
        (BlackBerry::WebKit::SelectionHandler::extendSelectionToFieldBoundary):
        * WebKitSupport/SelectionOverlay.cpp:
        (BlackBerry::WebKit::SelectionOverlay::draw):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update ColorPickerClient and PagePopupBlackBerry
        to match check-webkit-style updates.

        * WebCoreSupport/ColorPickerClient.cpp:
        (WebCore::ColorPickerClient::generateHTML):
        * WebCoreSupport/PagePopupBlackBerry.cpp:
        (WebCore::setValueAndClosePopupCallback):
        (WebCore::PagePopupBlackBerry::installDOMFunction):

2013-05-09  Alberto Garcia  <agarcia@igalia.com>

        [BlackBerry] Upstream the input popups
        https://bugs.webkit.org/show_bug.cgi?id=114608

        Reviewed by Rob Buis.

        This patch contains contributions from many members of the
        BlackBerry WebKit team, including:

        Chris Hutten-Czapski
        David Hoon
        Jessica Cao
        Rob Buis
        Tiancheng Jiang

        * WebCoreSupport/ColorPickerClient.cpp:
        (WebCore):
        (WebCore::ColorPickerClient::generateHTML):
        * WebCoreSupport/DatePickerClient.cpp:
        (WebCore):
        (WebCore::DatePickerClient::generateHTML):
        (WebCore::DatePickerClient::generateDateLabels):
        * WebCoreSupport/DatePickerClient.h:
        (DatePickerClient):
        * WebCoreSupport/SelectPopupClient.cpp:
        (WebCore):
        (WebCore::SelectPopupClient::generateHTML):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update DOMSupport to match check-webkit-style updates.

        * WebKitSupport/DOMSupport.cpp:
        (BlackBerry::WebKit::DOMSupport::isTextInputElement):
        (BlackBerry::WebKit::DOMSupport::isPasswordElement):
        (BlackBerry::WebKit::DOMSupport::convertPointToFrame):

2013-05-09  Xuefei Ren  <xren@blackberry.com>

        [BLACKBERRY]fix regression in Webpage
        and FrameLoaderClientBlackberry
        https://bugs.webkit.org/show_bug.cgi?id=115843

        Reviewed by Rob Buis.

        Internally reviewed by Mary Wu.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::loadFile):
        * WebCoreSupport/FrameLoaderClientBlackBerry.cpp:
        (WebCore::FrameLoaderClientBlackBerry::startDownload):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update FatFingers to match check-webkit-style updates.

        * WebKitSupport/FatFingers.cpp:
        (BlackBerry::WebKit::FatFingers::checkFingerIntersection):
        (BlackBerry::WebKit::FatFingers::checkForClickableElement):
        * WebKitSupport/FatFingers.h:
        (FatFingersResult):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Update InRegionScrollableArea, TileIndexHash
        and TouchEventHandler to match check-webkit-style updates.

        * WebKitSupport/InRegionScrollableArea.cpp:
        * WebKitSupport/TileIndexHash.h:
        * WebKitSupport/TouchEventHandler.cpp:
        (BlackBerry::WebKit::TouchEventHandler::drawTapHighlight):

2013-05-09  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Style updates required based on new check-webkit-style
        https://bugs.webkit.org/show_bug.cgi?id=115857

        Reviewed by Rob Buis.

        Styles fixes required for InputHandler based on updated
        check-webkit-style.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::spellCheckingRequestProcessed):
        (BlackBerry::WebKit::InputHandler::ensureFocusTextElementVisible):
        (BlackBerry::WebKit::InputHandler::ensureFocusPluginElementVisible):
        (BlackBerry::WebKit::InputHandler::setPopupListIndexes):
        (BlackBerry::WebKit::InputHandler::firstSpanInString):
        (BlackBerry::WebKit::InputHandler::setTextAttributes):
        * WebKitSupport/InputHandler.h:

2013-05-08  Eli Fidler  <efidler@blackberry.com>

        [BlackBerry] Fix usage of BlackBerry::Platform::String
        https://bugs.webkit.org/show_bug.cgi?id=115781

        Reviewed by Rob Buis.

        BlackBerry PRs 304193 and 327181
        Internally Reviewed by Mike Lattanzio, Arvid Nilsson, Joe Mason, Jeff Rogers, and George Staikos

        We currently have a problem where we're passing UTF-8 encoded data into
        the char* constructors of BlackBerry::Platform::String. This means the string
        thinks its data is not UTF-8.

        * Api/JavaScriptVariant.cpp:
        (BlackBerry::WebKit::JSValueRefToBlackBerryJavaScriptVariant):
        * Api/WebKitTextCodec.cpp:
        (BlackBerry::WebKit::base64Encode):
        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::loadFile):
        (BlackBerry::WebKit::WebPage::textEncoding):
        (BlackBerry::WebKit::WebPage::textHasAttribute):
        (BlackBerry::WebKit::WebPagePrivate::defaultUserAgent):
        * Api/WebPage.h:
        * Api/WebSettings.cpp:
        (BlackBerry::WebKit::WebSettings::standardSettings):
        * WebCoreSupport/FrameLoaderClientBlackBerry.cpp:
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidFinishLoad):
        (WebCore::FrameLoaderClientBlackBerry::dispatchDidReceiveIcon):
        * WebKitSupport/DefaultTapHighlight.cpp:
        (WebKit):
        (BlackBerry::WebKit::DefaultTapHighlight::draw):
        (BlackBerry::WebKit::DefaultTapHighlight::hide):

2013-05-08  Rob Buis  <rbuis@rim.com>

        Fix some compiler warnings (miscellaneous)
        https://bugs.webkit.org/show_bug.cgi?id=80790

        Reviewed by Philip Rogers.

        Get rid of the following warning for BlackBerry:

        BackingStoreClient.cpp:54:21: warning: unused parameter 'parentFrame' [-Wunused-parameter]

        by using ASSERT_UNUSED instead of ASSERT.

        * WebKitSupport/BackingStoreClient.cpp:
        (BlackBerry::WebKit::BackingStoreClient::create):

2013-05-07  Xuefei Ren  <xren@blackberry.com>

        Clean up load interface in WebPage
        https://bugs.webkit.org/show_bug.cgi?id=115622
        Reviewed by Rob Buis.

        Internal PR:315535
        Internal reviewed by  Mary Wu

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::load):
        (BlackBerry::WebKit::WebPage::loadFile):
        (BlackBerry::WebKit::WebPage::load):
        * Api/WebPage.h:
        * Api/WebPage_p.h:
        (WebPagePrivate):
        * WebCoreSupport/FrameLoaderClientBlackBerry.cpp:
        (WebCore::FrameLoaderClientBlackBerry::startDownload):

2013-05-07  Mike Fenton  <mifenton@rim.com>

        [BlackBerry] Increase the padding size for caret based scrolling.
        https://bugs.webkit.org/show_bug.cgi?id=115749

        Reviewed by Rob Buis.

        PR 322670.

        Increasing the padding size for scrolling in order to optimize the
        number of scrolls required during typing.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::ensureFocusTextElementVisible):

2013-05-07  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Maintain touch event state throughout processing
        https://bugs.webkit.org/show_bug.cgi?id=115663

        Reviewed by Rob Buis.

        Internally reviewed by Otto Cheung and Genevieve Mak.

        PR 297691
        By maintaining our touch event state, we can get a better idea
        of what triggered an update to selection and respond appropriately.
        On touch press we set userTouchTriggered to give the UI thread
        some context.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::WebPagePrivate):
        (BlackBerry::WebKit::WebPagePrivate::handleMouseEvent):
        (BlackBerry::WebKit::WebPage::setExtraPluginDirectory):
        * Api/WebPage_p.h:
        (WebPagePrivate):
        * WebKitSupport/SelectionHandler.cpp:
        (BlackBerry::WebKit::SelectionHandler::selectionPositionChanged):

2013-05-07  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Read-only fields should not get keyboard focus
        https://bugs.webkit.org/show_bug.cgi?id=115725

        Reviewed by Rob Buis.

        Internally reviewed by Mike Fenton.

        PR332887
        Prevent keyboard focus and FCC from displaying when the user taps on a
        read-only field. Further, ensure form controls skip over these fields
        with the next/previous buttons.

        * WebKitSupport/DOMSupport.cpp:
        (BlackBerry::WebKit::DOMSupport::elementIsReadOnly):
        (DOMSupport):
        * WebKitSupport/DOMSupport.h:
        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::focusedNodeChanged):
        (BlackBerry::WebKit::InputHandler::setInputModeEnabled):
        (BlackBerry::WebKit::InputHandler::notifyClientOfKeyboardVisibilityChange):
        (BlackBerry::WebKit::InputHandler::isActiveTextEdit):
        (WebKit):
        * WebKitSupport/InputHandler.h:

2013-05-07  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Expand spellcheck logging
        https://bugs.webkit.org/show_bug.cgi?id=115482

        Reviewed by Rob Buis.

        Internally reviewed by Mike Fenton.

        Fix some build errors when SpellingLog was turned on and expand on the debug
        statements to be more verbose. Set up timers and print the duration of each
        iteration as we traverse the text to create a range to send out for checking.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::spellCheckingRequestCancelled):
        (BlackBerry::WebKit::InputHandler::spellCheckingRequestProcessed):
        (BlackBerry::WebKit::InputHandler::setElementFocused):
        (WebKit):
        (BlackBerry::WebKit::InputHandler::spellCheckTextBlock):
        * WebKitSupport/SpellingHandler.cpp:
        (BlackBerry::WebKit::SpellingHandler::spellCheckTextBlock):
        (BlackBerry::WebKit::SpellingHandler::parseBlockForSpellChecking):

2013-05-06  Mike Lattanzio  <mlattanzio@blackberry.com>

        [BlackBerry] Enable and Expose Text Autosizing through BlackBerry::WebKit::WebSettings
        https://bugs.webkit.org/show_bug.cgi?id=113808

        Reviewed by Rob Buis.

        Create a WebSetting for text autosizing. The default is off.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::didChangeSettings):
        * Api/WebSettings.cpp:
        (WebKit):
        (BlackBerry::WebKit::WebSettings::standardSettings):
        (BlackBerry::WebKit::WebSettings::isTextAutosizingEnabled):
        (BlackBerry::WebKit::WebSettings::setTextAutosizingEnabled):
        * Api/WebSettings.h:

2013-05-06  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Ensure document is attached before accessing its FrameSelection
        https://bugs.webkit.org/show_bug.cgi?id=115565

        Reviewed by Rob Buis.

        Internally reviewed by Mike Fenton.

        PR 312101
        We need to make sure that the node and document
        are attached before accessing the FrameSelection. This was
        handled earlier but not all call paths were covered.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::setElementUnfocused):
        (BlackBerry::WebKit::InputHandler::isActiveTextEdit):
        (WebKit):
        * WebKitSupport/InputHandler.h:

2013-05-06  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Do not spellcheck when composition is active.
        https://bugs.webkit.org/show_bug.cgi?id=115562

        Reviewed by Rob Buis.

        Internally reviewed by Mike Fenton.

        PR331344
        Typing can trigger rechecking since layout changes. Ensure
        extra work is only done when we need it, and that it won't
        be triggered when composition is active. If the user hasn't
        finished a word yet, it is likely future key events will be
        arriving, so checking the string at this point is extraneous.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::requestCheckingOfString):

2013-05-06  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Reduce the spellcheck checking range
        https://bugs.webkit.org/show_bug.cgi?id=115479

        Reviewed by Rob Buis.

        Internally reviewed by Mike Fenton.

        PR332773
        Previously we were spellchecking the entire field on focus. If relayouting
        occurred we rechecked this region, which is very costly. Switch to check
        only a small region around the caret in both cases, which should alleviate
        much of the delays experienced in very large contenteditable fields. This
        allows for faster key input response and less time processing these requests
        on the WebKit thread.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::requestCheckingOfString):
        (BlackBerry::WebKit::InputHandler::spellCheckTextBlock):
        * WebKitSupport/SpellingHandler.cpp:
        (WebKit):
        (BlackBerry::WebKit::SpellingHandler::spellCheckTextBlock):
        * WebKitSupport/SpellingHandler.h:
        (SpellingHandler):

2013-05-06  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Use a more descriptive timer name
        https://bugs.webkit.org/show_bug.cgi?id=115481

        Reviewed by Rob Buis.

        Internally reviewed by Mike Fenton.

        Changing m_timer to m_iterationDelayTimer.

        * WebKitSupport/SpellingHandler.cpp:
        (BlackBerry::WebKit::SpellingHandler::SpellingHandler):
        (BlackBerry::WebKit::SpellingHandler::spellCheckTextBlock):
        (BlackBerry::WebKit::SpellingHandler::parseBlockForSpellChecking):
        * WebKitSupport/SpellingHandler.h:
        (SpellingHandler):

2013-05-04  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Clean up unused spellcheck code
        https://bugs.webkit.org/show_bug.cgi?id=115560

        Reviewed by Benjamin Poulain.
        Internally reviewed by Mike Lattanzio

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::setExtraPluginDirectory):
        * Api/WebPage.h:
        * WebKitSupport/InputHandler.cpp:
        * WebKitSupport/InputHandler.h:
        (InputHandler):

2013-05-03  Jacky Jiang  <zhajiang@blackberry.com>

        [BlackBerry] Page rendering scale is changed after go back and forward
        https://bugs.webkit.org/show_bug.cgi?id=115573

        Reviewed by Rob Buis.
        Internally reviewed by Jeff Rogers.

        PR: 326886
        When navigating back from page A with viewport to page B without
        viewport, we didn't call setViewMode(); therefore, we didn't change
        the fixed layout size which was set by page A. In that case, WebCore
        would just pick up page A's fixed layout size to layout page B which
        caused this issue.
        Expecting zoomToInitialScaleOnLoad() or other functions to setViewMode()
        later is not a good way, because zoomToInitialScaleOnLoad() has never
        been called in this case. So we should always call setViewMode() to set
        fixed layout size when a new page is committed.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::setLoadState):

2013-05-02  Genevieve Mak  <gmak@rim.com>

        [BlackBerry] Cannot touch scroll readonly text input.
        https://bugs.webkit.org/show_bug.cgi?id=115378

        Reviewed by Rob Buis.

        PR #332902
        Reviewed Internally by Mike Fenton.
        Forgot half the patch.
        Node::rendererIsEditable() returns false if the input element has the readonly tag set.
        Check the node type instead.

        * Api/InRegionScroller.cpp:
        (BlackBerry::WebKit::InRegionScrollerPrivate::canScrollRenderBox):

2013-05-02  Iris Wu  <shuwu@blackberry.com>

        [BlackBerry] Make scroll position adjustment work with pages with fixed position elements.
        https://bugs.webkit.org/show_bug.cgi?id=115178

        Reviewed by Rob Buis.

        PR 308796
        Debug build fix.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::fixedElementSizeDelta):

2013-05-01  Iris Wu  <shuwu@blackberry.com>

         [BlackBerry] Upstream smart selection
         https://bugs.webkit.org/show_bug.cgi?id=111226

        Reviewed by Rob Buis.

        Calling userInterfaceViewportAccessor()->documentViewportRect() on WK thread
        caused crash.
        But viewport from webkitThreadViewportAccessor uses unadjusted size which is
        wrong for email.
        The solution here is to get actual viewport size on UI thread and then pass it
        to WebKit::SelectionHandler.

        PR 333763
        Reviewed Internally By Jakob Petsovits.

        * Api/InRegionScroller.cpp:
        (BlackBerry::WebKit::InRegionScrollerPrivate::updateSelectionScrollView):
        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::setSelectionDocumentViewportSize):
        (WebKit):
        * Api/WebPage.h:
        * WebKitSupport/SelectionHandler.cpp:
        (BlackBerry::WebKit::SelectionHandler::selectAtPoint):
        (BlackBerry::WebKit::SelectionHandler::ensureSelectedTextVisible):
        (BlackBerry::WebKit::SelectionHandler::selectionViewportRect):
        * WebKitSupport/SelectionHandler.h:
        (BlackBerry::WebKit::SelectionHandler::setSelectionViewportSize):
        (BlackBerry::WebKit::SelectionHandler::setSelectionSubframeViewportRect):
        (SelectionHandler):

2013-04-30  Genevieve Mak  <gmak@rim.com>

        [BlackBerry] Cannot touch scroll readonly text input.
        https://bugs.webkit.org/show_bug.cgi?id=115378

        Reviewed by Rob Buis.

        PR #332902
        Reviewed Internally by Mike Fenton.
        Node::rendererIsEditable() returns false if the input element has the readonly tag set.
        Check the node type instead.

        * WebKitSupport/DOMSupport.cpp:
        (BlackBerry::WebKit::DOMSupport::isShadowHostTextInputElement):
        (DOMSupport):
        * WebKitSupport/DOMSupport.h:
        * WebKitSupport/InRegionScrollableArea.cpp:
        (BlackBerry::WebKit::InRegionScrollableArea::InRegionScrollableArea):

2013-04-29  Jakob Petsovits  <jpetsovits@blackberry.com>

        [BlackBerry] Replace disappearing fillBuffer() API with graphics context drawing
        https://bugs.webkit.org/show_bug.cgi?id=115360
        Internal PR 303048.

        Reviewed by Rob Buis.

        Instead of using fillBuffer() to draw directly to the
        target buffer, we now lock a Drawable on it and fill it
        with PlatformGraphicsContext::addPredefinedPattern().

        As a bonus, this also includes related clean-ups -
        simpler checkerboard painting code, removal of
        fillWindow(), clearWindow() and paintDefaultBackground(),
        as well as getting rid of the DEBUG_CHECKERBOARD define
        which has been useless for performance tracing purposes
        for a while now.

        * Api/BackingStore.cpp:
        (BlackBerry::WebKit::BackingStorePrivate::blitVisibleContents):
        * Api/BackingStore_p.h:

2013-04-26  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Check for valid element in elementTouched
        https://bugs.webkit.org/show_bug.cgi?id=115205

        Reviewed by Rob Buis.

        Internally reviewed by Genevieve Mak.

        PR 331546
        We might receive a null ptr from nodeAsElementIfApplicable which
        is passed in here. Check to make sure it's valid before using.

        * WebKitSupport/InputHandler.cpp:
        (BlackBerry::WebKit::InputHandler::elementTouched):

2013-04-26  Martin Robinson  <mrobinson@igalia.com>

        Remove the remaining Skia #ifdefs
        https://bugs.webkit.org/show_bug.cgi?id=114886

        Reviewed by Benjamin Poulain.

        * Api/WebPage.cpp: Remove Skia #ifdef references.
        * WebCoreSupport/AboutDataUseFeatures.in: Ditto.

2013-04-26  Mary Wu  <mary.wu@torchmobile.com.cn>

        [BlackBerry] Should check if it's cached resource before download
        https://bugs.webkit.org/show_bug.cgi?id=115101

        Reviewed by Rob Buis.

        Since main resource maybe cached, if user want to save the resource, we first check
        if it's cached. If yes, don't need to initiate a fresh load again, but get the
        cached resource data out to save.

        RIM bug# 324003, internally reviewed by Charles Wei.

        * WebCoreSupport/FrameLoaderClientBlackBerry.cpp:
        (WebCore::FrameLoaderClientBlackBerry::convertMainResourceLoadToDownload):

2013-04-26  Mary Wu  <mary.wu@torchmobile.com.cn>

        [BlackBerry] Clean up load interface in WebPage
        https://bugs.webkit.org/show_bug.cgi?id=113267

        Reviewed by Rob Buis.

        Remove unused loadExtended(), combine load() and download() api in WebPage.
        RIM Bug# 315535, internally reviewed by Joe Mason.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::load):
        * Api/WebPage.h:

2013-04-25  Andrew Lo  <anlo@rim.com>

        [BlackBerry] Selection overlay on non-composited iframes are incorrectly positioned.
        https://bugs.webkit.org/show_bug.cgi?id=115197

        Reviewed by Rob Buis.

        When drawing the selection overlay, the rects to
        paint when selecting text on non-composited sub-frames
        need to be adjusted by the frame position.

        * WebKitSupport/SelectionOverlay.cpp:
        (BlackBerry::WebKit::SelectionOverlay::paintContents):

2013-04-25  Andreas Kling  <akling@apple.com>

        Remove ENABLE(PARSED_STYLE_SHEET_CACHING) and make it always-on.

        Rubber-stamped by Anders Koivisto.

        * WebCoreSupport/AboutDataEnableFeatures.in:

2013-04-25  Iris Wu  <shuwu@blackberry.com>

        [BlackBerry] Make scroll position adjustment work with pages with fixed position elements.
        https://bugs.webkit.org/show_bug.cgi?id=115178

        Reviewed by Rob Buis.

        PR 308796

        Currently the position WebPage::adjustDocumentScrollPosition adjusts is the top
        left point of the viewport.
        On the page with fixed position elements, we want it to adjust the position beneath
        the fixed elements so it can be always visible.

        The basic idea is:
        1.  Detect if there are fixed position elements before going through ProximityDetector.
        2.  If the fixed element exists, calculate its the size and the actual visible position
            beneath it.
        3.  Pass the position to ProximityDetector. Then according to the new position we get,
            calculate the top left position of the viewport (final scroll position).

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::fixedElementSizeDelta):
        (WebKit):
        * Api/WebPage.h:
        * Api/WebPageCompositor.cpp:
        (BlackBerry::WebKit::WebPageCompositorPrivate::findFixedElementRect):
        (WebKit):
        * Api/WebPageCompositor_p.h:
        (WebPageCompositorPrivate):

2013-04-25  Mike Lattanzio  <mlattanzio@blackberry.com>

        [BlackBerry] Enable balanced page group load deferrer behaviour.
        https://bugs.webkit.org/show_bug.cgi?id=115189

        Reviewed by Rob Buis.

        Prevent a possible deadlock by enabling balanced deferrers.
        Internally reviewed by: Joe Mason
        PR 329986

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPagePrivate::init):

2013-04-25  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: ConsoleMessage should include line and column number where possible
        https://bugs.webkit.org/show_bug.cgi?id=114929

        Reviewed by Timothy Hatcher.

        * Api/DumpRenderTreeClient.h:
        * Api/WebPageClient.h:
        * WebCoreSupport/ChromeClientBlackBerry.cpp:
        (WebCore::ChromeClientBlackBerry::addMessageToConsole):
        * WebCoreSupport/ChromeClientBlackBerry.h:
        (ChromeClientBlackBerry):

2013-04-25  Konrad Piascik  <kpiascik@blackberry.com>

        [BlackBerry] Get rid of return in void method
        https://bugs.webkit.org/show_bug.cgi?id=115186

        Reviewed by Rob Buis.

        * Api/WebPage.cpp:
        (BlackBerry::WebKit::WebPage::setForcedTextEncoding):

2013-04-24  Nima Ghanavatian  <nghanavatian@blackberry.com>

        [BlackBerry] Do not clear focus on a node when tapping on form controls
        https://bugs.webkit.org/show_bug.cgi?id=115055

        Reviewed by Rob Buis.

        Internally reviewed by Genevieve Mak.

        PR316069
        To allow for rich text editors to apply styles on an input field
        or highlighted text, we must maintain focus on the current element
        when tapping on form elements. Moving the code that clears this
        context to trigger off TouchHold instead of TouchPress.

        * WebKitSupport/TouchEventHandler.cpp:
        (BlackBerry::WebKit::TouchEventHandler::doFatFingers):

== Rolled over to ChangeLog-2013-04-24 ==
